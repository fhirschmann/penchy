# -*- mode: python -*-

from penchy.jobs import *
import config

node1 = NodeConfiguration('192.168.56.11', 22, 'bench', '/home/bench', '/usr/bin')
node2 = NodeConfiguration('192.168.56.10', 22, 'bench', '/home/bench', '/usr/bin')


jvm = jvms.JVM('java')
jconfig1 = JVMNodeConfiguration(jvm, node1, name="Hello, Node!")
jconfig2 = JVMNodeConfiguration(jvm, node2, name="Hello, Node2!")

receiver = filters.Receive()

w = workloads.ScalaBench('dummy')
jvm.workload = w

f1 = filters.DacapoHarness()
f2 = filters.Send()

job = Job(configurations=[jconfig1, jconfig2],
          client_flow=[
              Edge(w, f1, [('stderr', 'stderr'),
                           ('exit_code', 'exit_code')]),
              Edge(f1, f2, ('times', 'payload'))
          ],
          server_flow=[
              Edge(receiver, filters.Print(), ('results', 'times'))
                      ],
          invocations = 2
          )
